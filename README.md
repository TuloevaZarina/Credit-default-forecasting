1. Введение

Целью данного проекта является построение модели машинного обучения, позволяющей прогнозировать вероятность невыполнения заемщиком текущих кредитных обязательств на основе исторических данных.

3. Постановка задачи

Дана обучающая выборка, содержащая информацию о клиентах банка. Необходимо:
Провести разведочный анализ данных.
Выполнить предобработку признаков.
При необходимости реализовать генерацию дополнительных признаков.
Построить модель классификации.
Оптимизировать гиперпараметры.
Максимизировать F1-score по положительному классу.
Выполнить прогноз для тестовой выборки.
Реализовать собственную логистическую регрессию и провести сравнение с библиотечной реализацией.

4. Описание данных
Использованы два набора данных:
course_project_train.csv — обучающая выборка;
course_project_test.csv — тестовая выборка.
Целевая переменная:
Credit Default
0 — обязательства выполнены;
1 — дефолт.
Признаки включают:
финансовые показатели заемщика;
характеристики кредитной истории;
категориальные признаки (тип жилья, цель кредита, срок кредита).

Обучающая выборка содержит 7500 наблюдений и 17 признаков.

4. Разведочный анализ данных (EDA)
На этапе EDA выполнены:
анализ распределения целевой переменной;
оценка доли пропусков;
анализ распределения числовых признаков;
анализ категориальных признаков.

Выявлено:
наличие дисбаланса классов (доля дефолтов ≈ 28%);
значительные пропуски в признаке Months since last delinquent;
необходимость кодирования категориальных переменных.

Дисбаланс классов обусловил использование корректирующих механизмов при обучении модели.

5. Предобработка данных
Для обеспечения корректной работы алгоритмов использован ColumnTransformer.
5.1 Числовые признаки
заполнение пропусков медианным значением;
стандартизация (StandardScaler).
5.2 Категориальные признаки
заполнение пропусков наиболее частым значением;
кодирование методом One-Hot Encoding.

Предобработка встроена в Pipeline, что исключает утечку данных.

6. Генерация признаков
Добавлен бинарный индикатор:
is_delinquent_missing
который отражает факт отсутствия информации о количестве месяцев с момента последней просрочки.

Данный признак позволяет учитывать структурные пропуски как потенциальный фактор риска.

7. Моделирование
7.1 Базовая модель
В качестве основной модели использована логистическая регрессия (sklearn).

Причины выбора:
интерпретируемость;
устойчивость;
эффективность при линейной разделимости;
корректная работа с дисбалансом классов.

Использован параметр:
class_weight = "balanced"

Для подбора гиперпараметра регуляризации C применена 5-fold стратифицированная кросс-валидация.

8. Оптимизация порога классификации
Поскольку стандартный порог 0.5 не гарантирует максимизацию F1-score, был выполнен перебор порога в диапазоне:
[0.05; 0.95]
Оптимальный порог выбран по максимальному F1-score на holdout-выборке.

9. Результаты
Для модели LogisticRegression (sklearn) получено:
оптимальный порог ≈ 0.41;
F1-score (по классу 1) ≈ 0.538.
Требование F1 > 0.5 выполнено.

10. Реализация собственной логистической регрессии
В рамках повышенного уровня сложности реализован алгоритм логистической регрессии с использованием:
сигмоидальной функции;
батч-градиентного спуска;
L2-регуляризации;
ручного подбора порога классификации.

Полученные результаты:
оптимальный порог ≈ 0.23;
F1-score ≈ 0.528.
Результаты сопоставимы с библиотечной реализацией, что подтверждает корректность реализации алгоритма.

11. Прогнозирование тестовой выборки
Финальная модель обучена на всей обучающей выборке.
Для тестового датасета:
применена идентичная предобработка;
использован оптимальный порог;
сформирован файл submission.csv.
Порядок строк тестовой выборки сохранён.

12. Выводы
Дисбаланс классов существенно влияет на метрику качества.
Подбор порога классификации является критически важным этапом.
Логистическая регрессия демонстрирует устойчивые результаты.
Самостоятельная реализация алгоритма подтверждает корректность математической модели.
Применение пайплайна исключает утечку данных и обеспечивает воспроизводимость эксперимента.

13. Заключение
В ходе выполнения проекта была реализована полная схема разработки модели машинного обучения для задачи кредитного скоринга.
Достигнуты требуемые показатели качества, выполнено сравнение алгоритмов, обеспечена воспроизводимость результатов.
Проект соответствует требованиям задания и демонстрирует практическое применение методов классификации в финансовой аналитике.
